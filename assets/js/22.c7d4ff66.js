(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{456:function(t,s,a){"use strict";a.r(s);var e=a(2),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"使用-github-pages-github-actions-部署前端项目-以-react-为例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-github-pages-github-actions-部署前端项目-以-react-为例"}},[t._v("#")]),t._v(" 使用 GitHub Pages & GitHub Actions 部署前端项目（以 React 为例）")]),t._v(" "),a("h2",{attrs:{id:"_1-在-github-上托管项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-在-github-上托管项目"}},[t._v("#")]),t._v(" 1.在 GitHub 上托管项目")]),t._v(" "),a("p",[t._v("像这样 --\x3e "),a("a",{attrs:{href:"https://github.com/baibai-lee/react-demo-deploy",target:"_blank",rel:"noopener noreferrer"}},[t._v("react-demo-deploy"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"_2-生成自动部署所依赖的-personal-access-token"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-生成自动部署所依赖的-personal-access-token"}},[t._v("#")]),t._v(" 2.生成自动部署所依赖的 personal access token")]),t._v(" "),a("p",[t._v("登陆 GitHub ，点击头像下的 setting\n"),a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/1.png",alt:"1.png"}})]),t._v(" "),a("p",[t._v("点击 Developer settings\n"),a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/2.png",alt:"2.png"}})]),t._v(" "),a("p",[t._v("点击 Personal access tokens > generate new token\n"),a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/3.png",alt:"3.png"}})]),t._v(" "),a("p",[t._v("给 token 起个名字，随后勾选下方的全部选项，点击生成\n"),a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/4.png",alt:"4.png"}}),t._v(" "),a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/5.png",alt:"5.png"}})]),t._v(" "),a("p",[t._v("复制生成的 token 并妥善保管\n此处需要注意的是，这个 token 有很高的你的账号的访问权限，因此千万不能泄露给别人，并且在刷新这个页面之后就不会再显示出来了\n"),a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/6.png",alt:"6.png"}})]),t._v(" "),a("p",[t._v("回到你的仓库，依次点击 Settings > Secrets > New secret\n"),a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/7.png",alt:"7.png"}})]),t._v(" "),a("p",[t._v("将 name 设置为 DEPLOY_KEY，并将刚才复制的 token 粘贴在下方\n"),a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/8.png",alt:"8.png"}})]),t._v(" "),a("p",[t._v("添加 Personal access token 成功\n"),a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/9.png",alt:"9.png"}})]),t._v(" "),a("h2",{attrs:{id:"_3-添加-ssh-key-到你的-github-账号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-添加-ssh-key-到你的-github-账号"}},[t._v("#")]),t._v(" 3.添加 ssh-key 到你的 GitHub 账号")]),t._v(" "),a("p",[t._v("有两个选择，一种是生成 key 之后直接添加的账户的 ssh-key，另一种是只添加到当前仓库的 Deploy keys 中，我们以第一种为例\n这两者的区别参考 --\x3e "),a("a",{attrs:{href:"https://segmentfault.com/q/1010000007356879",target:"_blank",rel:"noopener noreferrer"}},[t._v("github 上的账户的 SSH keys 与仓库的 Deploy keys 有何区别"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("ssh-keygen\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 无限回车")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" ~/.ssh/id_rsa.pub\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将输出粘贴至github的ssh-key管理中（https://github.com/settings/keys）")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/10.png",alt:"10.png"}})]),t._v(" "),a("h2",{attrs:{id:"_4-项目中添加-github-actions-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-项目中添加-github-actions-配置"}},[t._v("#")]),t._v(" 4.项目中添加 GitHub Actions 配置")]),t._v(" "),a("p",[t._v("在项目根目录下添加"),a("code",[t._v(".github/workflows/deploy.yml")]),t._v("文件，内容如下")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/baibai-lee/react-demo-deploy/blob/master/.github/workflows/deploy.yml",target:"_blank",rel:"noopener noreferrer"}},[t._v("deploy.yml"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Publish to Github Pages\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branches")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" master\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build-deploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18.04")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@master\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装依赖")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm ci\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打包")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npm run build\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 部署")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Deploy\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" peaceiris/actions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("gh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages@v2.5.0\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("PERSONAL_TOKEN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.DEPLOY_KEY "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("PUBLISH_BRANCH")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成文件的目录")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("PUBLISH_DIR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./build\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br")])]),a("h2",{attrs:{id:"_5-修改-homepage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-修改-homepage"}},[t._v("#")]),t._v(" 5.修改 homepage")]),t._v(" "),a("p",[t._v("在 package.json 中添加"),a("code",[t._v("homepage")]),t._v("字段，值为"),a("code",[t._v("https://baibai-lee.github.io/<your repositorie name>/")])]),t._v(" "),a("h2",{attrs:{id:"_6-提交代码并检测是否部署成功"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-提交代码并检测是否部署成功"}},[t._v("#")]),t._v(" 6.提交代码并检测是否部署成功")]),t._v(" "),a("p",[t._v("做完以上工作后就可以提交你的代码，GitHub Actions 会自动执行并将项目进行部署")]),t._v(" "),a("p",[t._v("回到仓库，点击 Actions > Publish to Github Pages，找到你这次的提交，检查任务是否成功执行\n"),a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/11.png",alt:"11.png"}}),t._v(" "),a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/12.png",alt:"12.png"}})]),t._v(" "),a("p",[t._v("点击 Settings > Options 往下翻，查看 GitHub Pages 是否成功添加\n"),a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/13.png",alt:"13.png"}})]),t._v(" "),a("p",[t._v("如果一切顺利，就可以看到你的项目啦 --\x3e "),a("a",{attrs:{href:"https://baibai-lee.github.io/react-demo-deploy/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://baibai-lee.github.io/react-demo-deploy/"),a("OutboundLink")],1),t._v(" "),a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/14.png",alt:"14.png"}})]),t._v(" "),a("h2",{attrs:{id:"可能存在的坑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可能存在的坑"}},[t._v("#")]),t._v(" 可能存在的坑")]),t._v(" "),a("ul",[a("li",[t._v("假如你的项目使用 yarn 进行包管理，在 GitHub Actions 中会出现错误，这个时候取巧一点的办法是，在本地执行以下"),a("code",[t._v("npm i")]),t._v("生成一下"),a("code",[t._v("package-lock.json")]),t._v(",再提交代码；一了百了的办法是直接把包管理器换成 npm")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://pics.leezx.cn/using-github-pages%26actions-to-deploy-projects/15.png",alt:"15.png"}})])])}),[],!1,null,null,null);s.default=n.exports}}]);